<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historical Higher Lower</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap');

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Poppins', sans-serif; background: #111; color: white; overflow: hidden; height: 100vh; width: 100vw; transition: background 0.2s; }

        /* --- Layout --- */
        .container { display: flex; width: 100%; height: 100%; position: relative; }
        
        .panel {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background-size: cover;
            background-position: center top;
            transition: all 0.5s ease;
        }

        .panel::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); z-index: 1;
            transition: background 0.3s;
        }

        /* Flash Effects */
        .flash-green::before { background: rgba(46, 213, 115, 0.8) !important; }
        .flash-red::before { background: rgba(255, 71, 87, 0.8) !important; }

        .content { position: relative; z-index: 2; padding: 20px; text-shadow: 0 2px 10px rgba(0,0,0,0.9); width: 100%; max-width: 600px; }

        h1 { font-size: 2.2rem; margin-bottom: 0.5rem; line-height: 1.2; }
        .year-display { font-size: 3.5rem; font-weight: 800; color: #fce303; display: block; margin-top: 10px; }
        .sub-text { font-size: 1.1rem; font-weight: 300; opacity: 0.9; }
        
        /* Did You Know Snippet */
        .wiki-snippet {
            font-size: 0.9rem; margin-top: 15px; line-height: 1.4;
            background: rgba(0,0,0,0.5); padding: 10px; border-radius: 10px;
            opacity: 0; transform: translateY(10px); transition: all 0.5s;
        }
        .wiki-snippet.show { opacity: 1; transform: translateY(0); }

        /* --- VS Circle --- */
        .vs-badge {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 50px; height: 50px; background: white; color: #111;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: 800; z-index: 10; box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* --- Buttons --- */
        .btn-group { display: flex; flex-direction: column; gap: 15px; margin-top: 25px; }
        
        button.guess-btn {
            background: rgba(255,255,255,0.15); border: 2px solid white; color: white;
            padding: 12px 35px; border-radius: 50px; font-size: 1.1rem; font-weight: 600;
            cursor: pointer; backdrop-filter: blur(5px); transition: all 0.2s; text-transform: uppercase;
        }

        button.guess-btn:hover { background: white; color: #111; transform: scale(1.05); }

        /* --- Top Bar & Controls --- */
        .top-bar {
            position: absolute; top: 0; left: 0; width: 100%; z-index: 40;
            padding: 20px; display: flex; justify-content: space-between; align-items: flex-start;
            pointer-events: none; /* Let clicks pass through to empty areas */
        }
        .top-bar > * { pointer-events: auto; }

        .back-btn {
            color: white; text-decoration: none; font-weight: 600;
            background: rgba(0,0,0,0.5); padding: 8px 15px; border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.3); font-size: 0.9rem;
        }

        .hud-right { text-align: right; }
        .score-val { font-size: 1.5rem; font-weight: 800; }
        .high-score { font-size: 0.8rem; opacity: 0.7; }

        /* Hard Mode Toggle */
        .mode-toggle {
            margin-top: 10px; display: inline-flex; align-items: center; gap: 8px;
            background: rgba(0,0,0,0.6); padding: 5px 10px; border-radius: 15px; font-size: 0.8rem;
        }
        .switch {
            position: relative; display: inline-block; width: 34px; height: 20px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; transition: .4s; border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: #ff4757; }
        input:checked + .slider:before { transform: translateX(14px); }

        /* --- Animations --- */
        .shake-anim { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-4px, 0, 0); }
            20%, 80% { transform: translate3d(8px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-16px, 0, 0); }
            40%, 60% { transform: translate3d(16px, 0, 0); }
        }

        .reveal-anim { animation: fadeInUp 0.5s ease forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Game Over Modal --- */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92); z-index: 100; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
        }
        .modal.active { display: flex; }
        .modal h2 { font-size: 3rem; color: #ff4757; margin-bottom: 10px; }
        .modal p { font-size: 1.2rem; margin-bottom: 30px; color: #ccc; max-width: 90%; }
        .restart-btn {
            background: #2ed573; border: none; color: white; padding: 15px 40px;
            font-size: 1.2rem; border-radius: 50px; cursor: pointer; font-weight: 600;
        }

        @media (max-width: 768px) {
            .container { flex-direction: column; }
            h1 { font-size: 1.5rem; }
            .year-display { font-size: 2.5rem; }
            .top-bar { padding: 10px; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <a href="index.html" class="back-btn">‚Üê Back</a>
        
        <div class="hud-right">
            <div>Score: <span class="score-val" id="score">0</span></div>
            <div class="high-score">Best: <span id="high-score">0</span></div>
            
            <div class="mode-toggle">
                <span>Hard Mode</span>
                <label class="switch">
                    <input type="checkbox" id="hard-mode-check">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>

    <div class="container" id="game-container">
        <div class="panel" id="left-panel">
            <div class="content">
                <h1 id="left-name">...</h1>
                <span class="sub-text">was born in</span>
                <span class="year-display" id="left-year">...</span>
                <div class="wiki-snippet show" id="left-snippet"></div>
            </div>
        </div>

        <div class="vs-badge">VS</div>

        <div class="panel" id="right-panel">
            <div class="content">
                <h1 id="right-name">...</h1>
                <span class="sub-text">was born...</span>
                
                <div class="btn-group" id="controls">
                    <button class="guess-btn" onclick="handleGuess('older')">Earlier (Older)</button>
                    <button class="guess-btn" onclick="handleGuess('younger')">Later (Younger)</button>
                </div>

                <div id="result-display" style="display: none;">
                    <span class="year-display" id="right-year">...</span>
                    <div class="wiki-snippet" id="right-snippet"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="modal">
        <h2>Game Over</h2>
        <p id="game-over-msg"></p>
        <button class="restart-btn" onclick="resetGame()">Play Again</button>
    </div>

    <script>
        // --- DATASET ---
        const database = [
            { n: "Hammurabi", y: -1810 }, { n: "Tutankhamun", y: -1341 }, { n: "Homer", y: -800 },
            { n: "Socrates", y: -470 }, { n: "Plato", y: -428 }, { n: "Aristotle", y: -384 },
            { n: "Alexander the Great", y: -356 }, { n: "Ashoka", y: -304 }, { n: "Qin Shi Huang", y: -259 },
            { n: "Hannibal", y: -247 }, { n: "Julius Caesar", y: -100 }, { n: "Cleopatra", y: -69 },
            { n: "Augustus", y: -63 }, { n: "Jesus", y: 0 }, { n: "Nero", y: 37 },
            { n: "Charlemagne", y: 742 }, { n: "William the Conqueror", y: 1028 }, { n: "Genghis Khan", y: 1162 },
            { n: "Dante Alighieri", y: 1265 }, { n: "Marco Polo", y: 1254 }, { n: "Joan of Arc", y: 1412 },
            { n: "Christopher Columbus", y: 1451 }, { n: "Leonardo da Vinci", y: 1452 }, { n: "Michelangelo", y: 1475 },
            { n: "Martin Luther", y: 1483 }, { n: "Henry VIII", y: 1491 }, { n: "Suleiman the Magnificent", y: 1494 },
            { n: "Elizabeth I", y: 1533 }, { n: "Galileo Galilei", y: 1564 }, { n: "William Shakespeare", y: 1564 },
            { n: "Pocahontas", y: 1596 }, { n: "Rembrandt", y: 1606 }, { n: "Louis XIV", y: 1638 },
            { n: "Isaac Newton", y: 1643 }, { n: "Johann Sebastian Bach", y: 1685 }, { n: "Voltaire", y: 1694 },
            { n: "Benjamin Franklin", y: 1706 }, { n: "Catherine the Great", y: 1729 }, { n: "George Washington", y: 1732 },
            { n: "Thomas Jefferson", y: 1743 }, { n: "Wolfgang Amadeus Mozart", y: 1756 }, { n: "Marie Antoinette", y: 1755 },
            { n: "Napoleon", y: 1769 }, { n: "Ludwig van Beethoven", y: 1770 }, { n: "Jane Austen", y: 1775 },
            { n: "Simon Bolivar", y: 1783 }, { n: "Abraham Lincoln", y: 1809 }, { n: "Charles Darwin", y: 1809 },
            { n: "Karl Marx", y: 1818 }, { n: "Queen Victoria", y: 1819 }, { n: "Florence Nightingale", y: 1820 },
            { n: "Louis Pasteur", y: 1822 }, { n: "Sitting Bull", y: 1831 }, { n: "Mark Twain", y: 1835 },
            { n: "Claude Monet", y: 1840 }, { n: "Thomas Edison", y: 1847 }, { n: "Vincent van Gogh", y: 1853 },
            { n: "Sigmund Freud", y: 1856 }, { n: "Nikola Tesla", y: 1856 }, { n: "Theodore Roosevelt", y: 1858 },
            { n: "Mahatma Gandhi", y: 1869 }, { n: "Vladimir Lenin", y: 1870 }, { n: "Winston Churchill", y: 1874 },
            { n: "Joseph Stalin", y: 1878 }, { n: "Albert Einstein", y: 1879 }, { n: "Helen Keller", y: 1880 },
            { n: "Pablo Picasso", y: 1881 }, { n: "Franklin D. Roosevelt", y: 1882 }, { n: "Coco Chanel", y: 1883 },
            { n: "Charlie Chaplin", y: 1889 }, { n: "Adolf Hitler", y: 1889 }, { n: "Amelia Earhart", y: 1897 },
            { n: "Walt Disney", y: 1901 }, { n: "Frida Kahlo", y: 1907 }, { n: "Mother Teresa", y: 1910 },
            { n: "Rosa Parks", y: 1913 }, { n: "Nelson Mandela", y: 1918 }, { n: "Marilyn Monroe", y: 1926 },
            { n: "Queen Elizabeth II", y: 1926 }, { n: "Che Guevara", y: 1928 }, { n: "Anne Frank", y: 1929 },
            { n: "Martin Luther King Jr.", y: 1929 }, { n: "Neil Armstrong", y: 1930 }, { n: "Elvis Presley", y: 1935 },
            { n: "John Lennon", y: 1940 }, { n: "Bruce Lee", y: 1940 }, { n: "Muhammad Ali", y: 1942 },
            { n: "Stephen Hawking", y: 1942 }, { n: "Bob Marley", y: 1945 }, { n: "Freddie Mercury", y: 1946 },
            { n: "Steven Spielberg", y: 1946 }, { n: "David Bowie", y: 1947 }, { n: "Oprah Winfrey", y: 1954 },
            { n: "Bill Gates", y: 1955 }, { n: "Steve Jobs", y: 1955 }, { n: "Michael Jackson", y: 1958 },
            { n: "Princess Diana", y: 1961 }, { n: "Barack Obama", y: 1961 }, { n: "Elon Musk", y: 1971 }
        ];

        // --- STATE ---
        let currentLeft, currentRight;
        let score = 0;
        let highScore = localStorage.getItem('histHighScore') || 0;
        let cache = {}; 
        let hardMode = false;

        // --- DOM ---
        const els = {
            leftName: document.getElementById('left-name'),
            leftYear: document.getElementById('left-year'),
            leftSnippet: document.getElementById('left-snippet'),
            leftPanel: document.getElementById('left-panel'),
            
            rightName: document.getElementById('right-name'),
            rightYear: document.getElementById('right-year'),
            rightSnippet: document.getElementById('right-snippet'),
            rightPanel: document.getElementById('right-panel'),
            
            controls: document.getElementById('controls'),
            result: document.getElementById('result-display'),
            score: document.getElementById('score'),
            highScore: document.getElementById('high-score'),
            modal: document.getElementById('modal'),
            failMsg: document.getElementById('game-over-msg'),
            container: document.getElementById('game-container'),
            hardModeCheck: document.getElementById('hard-mode-check')
        };

        els.highScore.innerText = highScore;

        // --- SOUND SYSTEM ---
        
        // 1. Preload the custom winning sound
        // Ensure you have uploaded 'win.mp3' to your GitHub folder!
        const winAudio = new Audio('win.mp3');
        winAudio.volume = 0.5; // Adjust volume as needed

        // 2. Synthesizer for Click/Lose (fallback)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            // -- WINNING SOUND (Custom) --
            if (type === 'win') {
                // Reset to start in case it's played rapidly
                winAudio.currentTime = 0;
                winAudio.play().catch(e => console.log("Audio play failed (user interaction required first)", e));
                return;
            }

            // -- OTHER SOUNDS (Synth) --
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            if (type === 'lose') {
                // Low Buzz
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            } else if (type === 'click') {
                // Short tick
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.1);
            }
        }

        // --- WIKIPEDIA API FETCH ---
        async function fetchWikiData(personName) {
            if (cache[personName]) return cache[personName];

            const url = `https://en.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(personName)}&prop=pageimages|extracts&pithumbsize=600&exsentences=2&explaintext&format=json&origin=*`;
            
            try {
                const res = await fetch(url);
                const data = await res.json();
                const pages = data.query.pages;
                const pageId = Object.keys(pages)[0];
                const page = pages[pageId];
                
                let imgUrl = page.thumbnail ? page.thumbnail.source : 'linear-gradient(45deg, #333, #555)';
                let text = page.extract || "A famous historical figure.";

                const result = { img: imgUrl, text: text };
                cache[personName] = result;
                return result;

            } catch (err) {
                console.error("Wiki API Error", err);
                return { img: 'linear-gradient(45deg, #333, #555)', text: "Could not load info." };
            }
        }

        function formatYear(y) {
            return y < 0 ? `${Math.abs(y)} BC` : y;
        }

        // --- GAME LOGIC ---
        function getRandomPerson(exclude) {
            if (hardMode && exclude) {
                const candidates = database.filter(p => 
                    p !== exclude && 
                    Math.abs(p.y - exclude.y) < 300 && 
                    Math.abs(p.y - exclude.y) > 0 
                );
                if (candidates.length > 0) {
                    return candidates[Math.floor(Math.random() * candidates.length)];
                }
            }

            let p;
            do {
                p = database[Math.floor(Math.random() * database.length)];
            } while (p === exclude || (exclude && p.y === exclude.y));
            return p;
        }

        async function updateUI(side, person) {
            const data = await fetchWikiData(person.n);
            
            if(side === 'left') {
                els.leftName.innerText = person.n;
                els.leftYear.innerText = formatYear(person.y);
                els.leftSnippet.innerText = data.text;
                els.leftPanel.style.backgroundImage = data.img.startsWith('http') ? `url('${data.img}')` : data.img;
            } else {
                els.rightName.innerText = person.n;
                els.rightSnippet.innerText = data.text; 
                els.rightPanel.style.backgroundImage = data.img.startsWith('http') ? `url('${data.img}')` : data.img;
            }
        }

        async function initGame() {
            score = 0;
            els.score.innerText = score;
            els.modal.classList.remove('active');
            
            currentLeft = getRandomPerson();
            currentRight = getRandomPerson(currentLeft);
            
            await updateUI('left', currentLeft);
            renderRightRound();
        }

        function renderRightRound() {
            els.controls.style.display = 'flex';
            els.result.style.display = 'none';
            els.rightYear.innerText = formatYear(currentRight.y);
            els.rightSnippet.classList.remove('show');
            updateUI('right', currentRight);

            els.rightPanel.classList.remove('reveal-anim');
            void els.rightPanel.offsetWidth; 
            els.rightPanel.classList.add('reveal-anim');
            
            els.rightPanel.classList.remove('flash-green', 'flash-red');
            els.container.classList.remove('shake-anim');
        }

        function handleGuess(guess) {
            playSound('click');
            
            const isOlder = currentRight.y < currentLeft.y; 
            const isYounger = currentRight.y > currentLeft.y; 
            let correct = (guess === 'older' && isOlder) || (guess === 'younger' && isYounger);

            els.controls.style.display = 'none';
            els.result.style.display = 'block';
            els.rightSnippet.classList.add('show');

            if (correct) {
                playSound('win');
                score++;
                els.score.innerText = score;
                els.rightPanel.classList.add('flash-green');

                setTimeout(() => {
                    currentLeft = currentRight;
                    currentRight = getRandomPerson(currentLeft);
                    els.leftPanel.style.backgroundImage = els.rightPanel.style.backgroundImage;
                    els.leftName.innerText = currentLeft.n;
                    els.leftYear.innerText = formatYear(currentLeft.y);
                    els.leftSnippet.innerText = els.rightSnippet.innerText;
                    renderRightRound();
                }, 2000); 
            } else {
                playSound('lose');
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('histHighScore', highScore);
                    els.highScore.innerText = highScore;
                }
                els.rightPanel.classList.add('flash-red');
                els.container.classList.add('shake-anim');

                els.failMsg.innerHTML = `<b>${currentRight.n}</b> was born in <b>${formatYear(currentRight.y)}</b>.`;
                setTimeout(() => els.modal.classList.add('active'), 2000);
            }
        }

        els.hardModeCheck.addEventListener('change', (e) => {
            hardMode = e.target.checked;
            playSound('click');
        });

        function resetGame() {
            initGame();
        }

        // Start
        initGame();

    </script>
</body>
</html>
